<div class="container">
  <div class="toolbar">
    <div class="search-box">
      <input 
        type="text" 
        [(ngModel)]="terminoBusqueda" 
        (input)="buscar()"
        placeholder="Buscar en todos los campos...">
    </div>
    
    <div class="action-buttons">
      <input 
        #fileInput
        type="file" 
        (change)="onFileSelected($event)"
        accept=".xls,.xlsx"
        class="hidden-file-input">
      <button class="btn btn-success" (click)="fileInput.click()">
        <i class="fas fa-file-upload"></i>
        Cargar Excel
      </button>
      <button class="btn btn-danger" (click)="vaciarLista()">
        <i class="fas fa-trash"></i>
        Vaciar Lista
      </button>
    </div>
  </div>

  <div class="table-container">
    <table>
      <thead>
        <tr>
          <th>Dispositivo</th>
          <th>Raza</th>
          <th>Cruza</th>
          <th>Sexo</th>
          <th>Edad (meses)</th>
          <th>Edad (días)</th>
          <th>Propietario</th>
          <th>Nombre Propietario</th>
          <th>Ubicación</th>
          <th>Tenedor</th>
          <th>Status de vida</th>
          <th>Status de trazabilidad</th>
          <th>Errores</th>
          <th>Fecha identificación</th>
          <th>Fecha registro</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let animal of animalesFiltrados" 
            (contextmenu)="onContextMenu($event, animal)"
            [class.selected]="animal === selectedAnimal">
          <td [innerHTML]="animal.dispositivo | highlight:terminoBusqueda"></td>
          <td [innerHTML]="animal.raza | highlight:terminoBusqueda"></td>
          <td [innerHTML]="animal.cruza | highlight:terminoBusqueda"></td>
          <td [innerHTML]="animal.sexo | highlight:terminoBusqueda"></td>
          <td [innerHTML]="(animal.edadMeses || 0).toString() | highlight:terminoBusqueda"></td>
          <td [innerHTML]="(animal.edadDias || 0).toString() | highlight:terminoBusqueda"></td>
          <td [innerHTML]="animal.propietario | highlight:terminoBusqueda"></td>
          <td [innerHTML]="animal.nombrePropietario | highlight:terminoBusqueda"></td>
          <td [innerHTML]="animal.ubicacion | highlight:terminoBusqueda"></td>
          <td [innerHTML]="animal.tenedor | highlight:terminoBusqueda"></td>
          <td [innerHTML]="animal.statusVida | highlight:terminoBusqueda"></td>
          <td [innerHTML]="animal.statusTrazabilidad | highlight:terminoBusqueda"></td>
          <td [innerHTML]="animal.errores | highlight:terminoBusqueda"></td>
          <td [innerHTML]="animal.fechaIdentificacion | highlight:terminoBusqueda"></td>
          <td [innerHTML]="animal.fechaRegistro | highlight:terminoBusqueda"></td>
        </tr>
        <tr *ngIf="animalesFiltrados.length === 0">
          <td colspan="15" class="empty-message">
            No hay datos disponibles. Arrastra un archivo Excel para cargar información.
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="drag-overlay" [class.active]="isDragging">
    <div class="drag-message">
      <i class="fas fa-file-excel"></i>
      <h3>Suelta el archivo Excel aquí</h3>
      <p>Arrastra y suelta tu archivo .xls o .xlsx para cargar los datos</p>
    </div>
  </div>
</div> 